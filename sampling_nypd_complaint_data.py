# -*- coding: utf-8 -*-
"""Sampling NYPD Complaint Data.ipynb

Automatically generated by Colaboratory.

## Sampling NYPD Complaint Data
"""

import pandas as pd

from google.colab import files
uploaded=files.upload()

df = pd.read_csv('NYPD_Complaint_Data_Historic.csv')

df

loc = df['PREM_TYP_DESC'].drop_duplicates() # drop duplicate data
for i in loc:
  print(i)

from google.colab import drive  #  mounting Google Drive files
drive.mount('/content/gdrive') 

subway_data = df[df['PREM_TYP_DESC'] == 'TRANSIT - NYC SUBWAY'].drop(columns=['PARKS_NM', 'HADEVELOPT', 
                              'HOUSING_PSA', 'TRANSIT_DISTRICT',
                              'STATION_NAME', 'Lat_Lon', 'LOC_OF_OCCUR_DESC',
                              'CMPLNT_TO_DT', 'CMPLNT_TO_TM']).dropna().reset_index(drop=True)
subway_data.to_csv('/content/gdrive/My Drive/Colab Notebooks/Criminal_Prediction/Subway_Data.csv')

tramway_data = df[df['PREM_TYP_DESC'] == 'TRAMWAY'].drop(columns=['PARKS_NM', 'HADEVELOPT', 
                              'HOUSING_PSA', 'TRANSIT_DISTRICT',
                              'STATION_NAME', 'Lat_Lon', 'LOC_OF_OCCUR_DESC',
                              'CMPLNT_TO_DT', 'CMPLNT_TO_TM']).dropna().reset_index(drop=True)
tramway_data.to_csv('/content/gdrive/My Drive/Colab Notebooks/Criminal_Prediction/Tramway_Data.csv')

nyc_bus_data = df[df['PREM_TYP_DESC'] == 'BUS (NYC TRANSIT)'].drop(columns=['PARKS_NM', 'HADEVELOPT', 
                              'HOUSING_PSA', 'TRANSIT_DISTRICT',
                              'STATION_NAME', 'Lat_Lon', 'LOC_OF_OCCUR_DESC',
                              'CMPLNT_TO_DT', 'CMPLNT_TO_TM']).dropna().reset_index(drop=True)
nyc_bus_data.to_csv('/content/gdrive/My Drive/Colab Notebooks/Criminal_Prediction/NYC_Bus_Data.csv')

other_bus_data = df[df['PREM_TYP_DESC'] == 'BUS (OTHER)'].drop(columns=['PARKS_NM', 'HADEVELOPT', 
                              'HOUSING_PSA', 'TRANSIT_DISTRICT',
                              'STATION_NAME', 'Lat_Lon', 'LOC_OF_OCCUR_DESC',
                              'CMPLNT_TO_DT', 'CMPLNT_TO_TM']).dropna().reset_index(drop=True)
other_bus_data.to_csv('/content/gdrive/My Drive/Colab Notebooks/Criminal_Prediction/Other_Bus_Data.csv')

chain_store_data = df[df['PREM_TYP_DESC'] == 'CHAIN STORE'].drop(columns=['PARKS_NM', 'HADEVELOPT', 
                              'HOUSING_PSA', 'TRANSIT_DISTRICT',
                              'STATION_NAME', 'Lat_Lon', 'LOC_OF_OCCUR_DESC',
                              'CMPLNT_TO_DT', 'CMPLNT_TO_TM']).dropna().reset_index(drop=True)
chain_store_data.to_csv('/content/gdrive/My Drive/Colab Notebooks/Criminal_Prediction/Chain_Store_Data.csv')

date = df['CMPLNT_FR_DT']

date = date.replace(to_replace ="/", 
                 value ="", regex=True)

date.dropna().astype(int)

def conv(x):
    return pd.Period(month=x // 1000000, day=x // 10000 % 100, year=x % 10000, freq='D')

date = date.dropna().astype(int).apply(conv)

date

date.dt.year.drop_duplicates().sort_values

df['CMPLNT_FR_DT'] = date

df1 = df[df['CMPLNT_FR_DT'].dt.year >= 2010]

df1 = df1.reset_index(drop=True)

df1

int(df1.shape[0] * 0.1)

sample_data = df1.sample(n=int(df1.shape[0] * 0.1), random_state=None)

sample_data.to_csv('NYPD_Complaint_Sample_Data.csv')