# -*- coding: utf-8 -*-
"""NYC Weather Data Analysis.ipynb

Automatically generated by Colaboratory.

## NYC Weather Data Analysis
"""


import pandas as pd
df = pd.read_csv('2019_NYC_weather.csv')

df = df.drop(columns=['Date', 'Unnamed: 0'])
df['Date'] = pd.date_range(start='1/1/2010', end='12/31/2019')
df = df.set_index('Date')

fig = plt.figure(figsize=(22,10))
plt.plot(df.index, df.Temperature_Max, label='Max Temp')
plt.plot(df.index, df.Temperature_Avg, label='Avg Temp')
plt.plot(df.index, df.Temperature_Min, label='Min Temp')
plt.xticks(size=12)
plt.yticks(size=12)
plt.title('2010-2019 NYC Temperature', size=25)
plt.grid()
plt.legend(prop={'size': 12})
plt.tight_layout()
plt.show()

year_list=[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019]

import matplotlib.pyplot as plt

fig=plt.figure(figsize=(26,38))
for i in range(len(year_list)):
    plt.subplot(5,2,i+1)
    plt.plot(df[df.index.year==year_list[i]].index, df[df.index.year==year_list[i]].Temperature_Max, label='Max Temp')
    plt.plot(df[df.index.year==year_list[i]].index, df[df.index.year==year_list[i]].Temperature_Avg, label='Avg Temp')
    plt.plot(df[df.index.year==year_list[i]].index, df[df.index.year==year_list[i]].Temperature_Min, label='Min Temp')
    plt.legend()
    plt.grid()

fig = plt.figure(figsize=(22,10))
plt.plot(df[df.index.year==2012].index, df[df.index.year==2012].Temperature_Max, label='Max Temp')
plt.plot(df[df.index.year==2012].index, df[df.index.year==2012].Temperature_Avg, label='Avg Temp')
plt.plot(df[df.index.year==2012].index, df[df.index.year==2012].Temperature_Min, label='Min Temp')
plt.xticks(size=12)
plt.yticks(size=12)
plt.title('NYC-2012-Temperature', size=25)
plt.grid()
plt.legend(prop={'size': 12})
plt.tight_layout()

df['year'] = df.index.year
df['month'] = df.index.month
df['ym'] = df.index.to_period('M')
df1 = df[df.year>=2014]

df2 = pd.DataFrame(df1.groupby('ym').Precipitation.sum(), index=df1.ym.drop_duplicates())
df2['month'] = df2.index.month
df2['year'] = df2.index.year

import plotly.graph_objects as go

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
          'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']

fig = go.Figure()
fig.add_trace(go.Bar(
    x=df2[df2.year==2014].month,
    y=df2[df2.year==2014].Precipitation,
    name='2014'
))
fig.add_trace(go.Bar(
    x=df2[df2.year==2015].month,
    y=df2[df2.year==2015].Precipitation,
    name='2015'
))
fig.add_trace(go.Bar(
    x=df2[df2.year==2016].month,
    y=df2[df2.year==2016].Precipitation,
    name='2016'
))
fig.add_trace(go.Bar(
    x=df2[df2.year==2017].month,
    y=df2[df2.year==2017].Precipitation,
    name='2017'
))
fig.add_trace(go.Bar(
    x=df2[df2.year==2018].month,
    y=df2[df2.year==2018].Precipitation,
    name='2018'
))
fig.add_trace(go.Bar(
    x=df2[df2.year==2019].month,
    y=df2[df2.year==2019].Precipitation,
    name='2019'
))

# Here we modify the tickangle of the xaxis, resulting in rotated labels.
fig.update_layout(barmode='group')
fig.show()